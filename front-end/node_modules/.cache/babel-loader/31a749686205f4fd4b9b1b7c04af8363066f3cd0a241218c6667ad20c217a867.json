{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst tslib_1 = require(\"tslib\");\nconst react_1 = (0, tslib_1.__importStar)(require(\"react\"));\nconst omit_1 = (0, tslib_1.__importDefault)(require(\"lodash/omit\"));\nconst isFunction_1 = (0, tslib_1.__importDefault)(require(\"lodash/isFunction\"));\nconst getNewValue_1 = (0, tslib_1.__importDefault)(require(\"./getNewValue\"));\nconst isReactNative_1 = (0, tslib_1.__importDefault)(require(\"../utility/isReactNative\"));\nconst Contexts_1 = require(\"../Contexts\");\nconst cloneDeep_1 = (0, tslib_1.__importDefault)(require(\"lodash/cloneDeep\"));\nconst isNil_1 = (0, tslib_1.__importDefault)(require(\"lodash/isNil\"));\nconst use_deep_compare_effect_1 = (0, tslib_1.__importDefault)(require(\"use-deep-compare-effect\"));\nfunction Form(props, ref) {\n  const [state, setState] = (0, react_1.useState)((0, cloneDeep_1.default)(props.state) || {});\n  const omitOnChangeEvent = (0, react_1.useRef)(true);\n  const resetState = () => {\n    setState((0, cloneDeep_1.default)(props.state));\n  };\n  (0, use_deep_compare_effect_1.default)(() => {\n    if (!(0, isNil_1.default)(props.state)) {\n      resetState();\n    }\n  }, [props.state || {}]);\n  (0, use_deep_compare_effect_1.default)(() => {\n    if (omitOnChangeEvent.current) {\n      omitOnChangeEvent.current = false;\n      return;\n    }\n    if ((0, isFunction_1.default)(props.onChange)) {\n      props.onChange(state);\n    }\n  }, [state]);\n  const onChange = (fieldName, fieldValue) => {\n    setState(oldValue => (0, getNewValue_1.default)(oldValue, fieldName, fieldValue));\n  };\n  const submit = () => {\n    if (!(0, isFunction_1.default)(props.onSubmit)) return;\n    return props.onSubmit(state);\n  };\n  const onFormSubmit = event => {\n    event.preventDefault();\n    return submit();\n  };\n  (0, react_1.useImperativeHandle)(ref, () => ({\n    submit,\n    getValue: () => state,\n    reset: resetState\n  }));\n  const renderChild = () => {\n    const domProps = (0, omit_1.default)(props, 'children', 'state', 'onChange', 'errorMessages', 'useFormTag', 'onSubmit');\n    if ((0, isReactNative_1.default)()) {\n      return props.children;\n    }\n    if (props.useFormTag !== false) {\n      return react_1.default.createElement(\"form\", {\n        ...domProps,\n        onSubmit: onFormSubmit\n      }, props.children);\n    } else {\n      return props.children;\n    }\n  };\n  return react_1.default.createElement(Contexts_1.ParentFieldNameContext.Provider, {\n    value: null\n  }, react_1.default.createElement(Contexts_1.ErrorMessagesContext.Provider, {\n    value: props.errorMessages\n  }, react_1.default.createElement(Contexts_1.OnChangeContext.Provider, {\n    value: onChange\n  }, react_1.default.createElement(Contexts_1.ValueContext.Provider, {\n    value: state\n  }, renderChild()))));\n}\nexports.default = (0, react_1.forwardRef)(Form);","map":{"version":3,"names":["react_1","tslib_1","__importStar","require","omit_1","__importDefault","isFunction_1","getNewValue_1","isReactNative_1","Contexts_1","cloneDeep_1","isNil_1","use_deep_compare_effect_1","Form","props","ref","state","setState","useState","default","omitOnChangeEvent","useRef","resetState","current","onChange","fieldName","fieldValue","oldValue","submit","onSubmit","onFormSubmit","event","preventDefault","useImperativeHandle","getValue","reset","renderChild","domProps","children","useFormTag","createElement","ParentFieldNameContext","Provider","value","ErrorMessagesContext","errorMessages","OnChangeContext","ValueContext","exports","forwardRef"],"sources":["../../src/Form/index.tsx"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}