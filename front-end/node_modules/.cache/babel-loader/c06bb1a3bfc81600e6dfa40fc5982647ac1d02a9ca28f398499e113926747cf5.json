{"ast":null,"code":"var _jsxFileName = \"/home/ishwore/Documents/VehicleRent/front-end/src/screen/Khalti.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport KhaltiCheckout from \"khalti-checkout-web\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst KhaltiPaymentComponent = ({\n  id,\n  name,\n  vid\n}) => {\n  _s();\n  const auth = localStorage.getItem('user');\n  const [idx, setId] = useState('');\n  const [user, setUser] = useState('');\n  const [token, setToken] = useState('');\n  const [paidAmt, setAmt] = useState('');\n  const email_address = JSON.parse(auth).email;\n  const handlePayment = () => {\n    const config = {\n      publicKey: \"test_public_key_20ba6979112a4822bc3bdcb767d84dcf\",\n      productIdentity: `${vid}`,\n      productName: `${name}`,\n      productUrl: `http://localhost:3000/veiwbookingdetails/${id}`,\n      eventHandler: {\n        onSuccess: async payload => {\n          console.log(payload);\n          const result = await fetch(\"http://localhost:5000/api/khalti\", {\n            method: 'post',\n            body: JSON.stringify({\n              payload\n            }),\n            headers: {\n              'Content-Type': 'application/json',\n              Authorization: `Bearer ${JSON.parse(auth).token}`\n            }\n          });\n          const resultData = await result.json();\n          console.log(resultData);\n          setAmt(resultData.amount);\n          setId(resultData.idx);\n          setToken(resultData.token);\n          setUser(resultData.user.name);\n          console.log(paidAmt, user, email_address, token, idx);\n          if (paidAmt !== '' || user !== '' || email_address !== '' || token !== '' || idx !== '') {\n            const paymentResult = {\n              idx,\n              email_address,\n              paidAmt,\n              user,\n              token\n            };\n            console.log(paymentResult);\n            const result = await fetch(`http://localhost:5000/api/booking/${id}/pay`, {\n              method: 'put',\n              body: JSON.stringify({\n                paymentResult\n              }),\n              headers: {\n                'Content-Type': 'application/json',\n                Authorization: `Bearer ${JSON.parse(auth).token}`\n              }\n            });\n            const resultData = await result.json();\n            console.log(resultData);\n            if (resultData !== '') {\n              alert(\"Payment Successful !\");\n            }\n          }\n\n          // setTimeout(() => {\n          //     console.log(paidAmt, user, email_address, token, idx);\n          // }, 4000);\n          // console.warn(resultData);\n          // console.log(resultData);\n        },\n\n        onError: error => {\n          console.log(error);\n        },\n        onClose: () => {\n          console.log(\"widget is closing\");\n        }\n      },\n      paymentPreference: [\"KHALTI\"]\n    };\n    const checkout = new KhaltiCheckout(config);\n    checkout.show({\n      amount: 1000\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    id: \"payment-button \",\n    className: \"bg-red-500 rounded-2xl px-3 py-2 text-white\",\n    onClick: handlePayment,\n    children: \"Pay with Khalti\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 9\n  }, this);\n};\n_s(KhaltiPaymentComponent, \"nkYyMhpEw2cLGiXK+dexxDEh8xM=\");\n_c = KhaltiPaymentComponent;\nexport default KhaltiPaymentComponent;\nvar _c;\n$RefreshReg$(_c, \"KhaltiPaymentComponent\");","map":{"version":3,"names":["React","useState","KhaltiCheckout","jsxDEV","_jsxDEV","KhaltiPaymentComponent","id","name","vid","_s","auth","localStorage","getItem","idx","setId","user","setUser","token","setToken","paidAmt","setAmt","email_address","JSON","parse","email","handlePayment","config","publicKey","productIdentity","productName","productUrl","eventHandler","onSuccess","payload","console","log","result","fetch","method","body","stringify","headers","Authorization","resultData","json","amount","paymentResult","alert","onError","error","onClose","paymentPreference","checkout","show","className","onClick","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/ishwore/Documents/VehicleRent/front-end/src/screen/Khalti.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport KhaltiCheckout from \"khalti-checkout-web\";\n\nconst KhaltiPaymentComponent = ({ id, name, vid }) => {\n    const auth = localStorage.getItem('user');\n    const [idx, setId] = useState('');\n    const [user, setUser] = useState('');\n    const [token, setToken] = useState('');\n    const [paidAmt, setAmt] = useState('');\n    const email_address = JSON.parse(auth).email;\n    const handlePayment = () => {\n        const config = {\n            publicKey: \"test_public_key_20ba6979112a4822bc3bdcb767d84dcf\",\n            productIdentity: `${vid}`,\n            productName: `${name}`,\n            productUrl: `http://localhost:3000/veiwbookingdetails/${id}`,\n            eventHandler: {\n                onSuccess: async (payload) => {\n                    console.log(payload);\n                    const result = await fetch(\"http://localhost:5000/api/khalti\", {\n                        method: 'post',\n                        body: JSON.stringify({ payload }),\n                        headers: {\n                            'Content-Type': 'application/json',\n                            Authorization: `Bearer ${JSON.parse(auth).token}`,\n                        },\n                    });\n                    const resultData = await result.json();\n                    console.log(resultData);\n                    setAmt(resultData.amount);\n                    setId(resultData.idx);\n                    setToken(resultData.token);\n                    setUser(resultData.user.name);\n                    console.log(paidAmt, user, email_address, token, idx);\n\n                    if (paidAmt !== '' || user !== '' || email_address !== '' || token !== '' || idx !== '') {\n                        const paymentResult = { idx, email_address, paidAmt, user, token };\n                        console.log(paymentResult);\n\n                        const result = await fetch(`http://localhost:5000/api/booking/${id}/pay`, {\n                            method: 'put',\n                            body: JSON.stringify({ paymentResult }),\n                            headers: {\n                                'Content-Type': 'application/json',\n                                Authorization: `Bearer ${JSON.parse(auth).token}`,\n                            },\n                        });\n                        const resultData = await result.json();\n                        console.log(resultData);\n                        if (resultData !== '') {\n                            alert(\"Payment Successful !\");\n                        }\n\n                    }\n\n                    // setTimeout(() => {\n                    //     console.log(paidAmt, user, email_address, token, idx);\n                    // }, 4000);\n                    // console.warn(resultData);\n                    // console.log(resultData);\n\n                },\n                onError: (error) => {\n                    console.log(error);\n                },\n                onClose: () => {\n                    console.log(\"widget is closing\");\n                },\n            },\n            paymentPreference: [\"KHALTI\"],\n        };\n\n        const checkout = new KhaltiCheckout(config);\n        checkout.show({ amount: 1000 });\n    };\n\n    return (\n        <button id=\"payment-button \" className=\"bg-red-500 rounded-2xl px-3 py-2 text-white\" onClick={handlePayment}>\n            Pay with Khalti\n        </button>\n    );\n};\n\nexport default KhaltiPaymentComponent;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,QAAQ,OAAO;AACvC,OAAOC,cAAc,MAAM,qBAAqB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEjD,MAAMC,sBAAsB,GAAGA,CAAC;EAAEC,EAAE;EAAEC,IAAI;EAAEC;AAAI,CAAC,KAAK;EAAAC,EAAA;EAClD,MAAMC,IAAI,GAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;EACzC,MAAM,CAACC,GAAG,EAAEC,KAAK,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;EACjC,MAAM,CAACc,IAAI,EAAEC,OAAO,CAAC,GAAGf,QAAQ,CAAC,EAAE,CAAC;EACpC,MAAM,CAACgB,KAAK,EAAEC,QAAQ,CAAC,GAAGjB,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACkB,OAAO,EAAEC,MAAM,CAAC,GAAGnB,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAMoB,aAAa,GAAGC,IAAI,CAACC,KAAK,CAACb,IAAI,CAAC,CAACc,KAAK;EAC5C,MAAMC,aAAa,GAAGA,CAAA,KAAM;IACxB,MAAMC,MAAM,GAAG;MACXC,SAAS,EAAE,kDAAkD;MAC7DC,eAAe,EAAG,GAAEpB,GAAI,EAAC;MACzBqB,WAAW,EAAG,GAAEtB,IAAK,EAAC;MACtBuB,UAAU,EAAG,4CAA2CxB,EAAG,EAAC;MAC5DyB,YAAY,EAAE;QACVC,SAAS,EAAE,MAAOC,OAAO,IAAK;UAC1BC,OAAO,CAACC,GAAG,CAACF,OAAO,CAAC;UACpB,MAAMG,MAAM,GAAG,MAAMC,KAAK,CAAC,kCAAkC,EAAE;YAC3DC,MAAM,EAAE,MAAM;YACdC,IAAI,EAAEjB,IAAI,CAACkB,SAAS,CAAC;cAAEP;YAAQ,CAAC,CAAC;YACjCQ,OAAO,EAAE;cACL,cAAc,EAAE,kBAAkB;cAClCC,aAAa,EAAG,UAASpB,IAAI,CAACC,KAAK,CAACb,IAAI,CAAC,CAACO,KAAM;YACpD;UACJ,CAAC,CAAC;UACF,MAAM0B,UAAU,GAAG,MAAMP,MAAM,CAACQ,IAAI,CAAC,CAAC;UACtCV,OAAO,CAACC,GAAG,CAACQ,UAAU,CAAC;UACvBvB,MAAM,CAACuB,UAAU,CAACE,MAAM,CAAC;UACzB/B,KAAK,CAAC6B,UAAU,CAAC9B,GAAG,CAAC;UACrBK,QAAQ,CAACyB,UAAU,CAAC1B,KAAK,CAAC;UAC1BD,OAAO,CAAC2B,UAAU,CAAC5B,IAAI,CAACR,IAAI,CAAC;UAC7B2B,OAAO,CAACC,GAAG,CAAChB,OAAO,EAAEJ,IAAI,EAAEM,aAAa,EAAEJ,KAAK,EAAEJ,GAAG,CAAC;UAErD,IAAIM,OAAO,KAAK,EAAE,IAAIJ,IAAI,KAAK,EAAE,IAAIM,aAAa,KAAK,EAAE,IAAIJ,KAAK,KAAK,EAAE,IAAIJ,GAAG,KAAK,EAAE,EAAE;YACrF,MAAMiC,aAAa,GAAG;cAAEjC,GAAG;cAAEQ,aAAa;cAAEF,OAAO;cAAEJ,IAAI;cAAEE;YAAM,CAAC;YAClEiB,OAAO,CAACC,GAAG,CAACW,aAAa,CAAC;YAE1B,MAAMV,MAAM,GAAG,MAAMC,KAAK,CAAE,qCAAoC/B,EAAG,MAAK,EAAE;cACtEgC,MAAM,EAAE,KAAK;cACbC,IAAI,EAAEjB,IAAI,CAACkB,SAAS,CAAC;gBAAEM;cAAc,CAAC,CAAC;cACvCL,OAAO,EAAE;gBACL,cAAc,EAAE,kBAAkB;gBAClCC,aAAa,EAAG,UAASpB,IAAI,CAACC,KAAK,CAACb,IAAI,CAAC,CAACO,KAAM;cACpD;YACJ,CAAC,CAAC;YACF,MAAM0B,UAAU,GAAG,MAAMP,MAAM,CAACQ,IAAI,CAAC,CAAC;YACtCV,OAAO,CAACC,GAAG,CAACQ,UAAU,CAAC;YACvB,IAAIA,UAAU,KAAK,EAAE,EAAE;cACnBI,KAAK,CAAC,sBAAsB,CAAC;YACjC;UAEJ;;UAEA;UACA;UACA;UACA;UACA;QAEJ,CAAC;;QACDC,OAAO,EAAGC,KAAK,IAAK;UAChBf,OAAO,CAACC,GAAG,CAACc,KAAK,CAAC;QACtB,CAAC;QACDC,OAAO,EAAEA,CAAA,KAAM;UACXhB,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC;QACpC;MACJ,CAAC;MACDgB,iBAAiB,EAAE,CAAC,QAAQ;IAChC,CAAC;IAED,MAAMC,QAAQ,GAAG,IAAIlD,cAAc,CAACwB,MAAM,CAAC;IAC3C0B,QAAQ,CAACC,IAAI,CAAC;MAAER,MAAM,EAAE;IAAK,CAAC,CAAC;EACnC,CAAC;EAED,oBACIzC,OAAA;IAAQE,EAAE,EAAC,iBAAiB;IAACgD,SAAS,EAAC,6CAA6C;IAACC,OAAO,EAAE9B,aAAc;IAAA+B,QAAA,EAAC;EAE7G;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAQ,CAAC;AAEjB,CAAC;AAACnD,EAAA,CA9EIJ,sBAAsB;AAAAwD,EAAA,GAAtBxD,sBAAsB;AAgF5B,eAAeA,sBAAsB;AAAC,IAAAwD,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}